#1 乐享畅聊

### 服务器的实现

使用同步阻塞多线程模型,利用多线程与多个客户端进行交互。服务端数据使用MySQL数据库存储。

监听线程循环监听客户端的连接，每连接一个客户端创建一个对应线程去循环接收这个客户端的数据，并做对应的处理。

### 客户端的实现

**双线程：**

GUI线程图形切换和用户交互

数据接收线程接收服务器转发的数据，中介者对象跨线程发信号给Kernel类的槽函数，由GUI线程做对应的界面变换。



客户端实现了网络父类，父类有两个子类是TCP和udp功能类


实现一个终结者类，他的内部实现一个成员指针，网络功能类指针，通过多态的方式指向一个申请在堆区的TCP网络功能类对象开启客户端 定义一个核心功能类对象，执行这个类的构造函数，在构造函数里面创建新的注册窗口，绑定注册窗口上面的信息处理的信号和槽函数，妞，一个新的朋友列表绑定列表中朋友的信息处理的各种槽函数


new一个成员指针终结者，它的内部申请一个自己的成员指针指向一个堆砌的TCP功能类对象，打开网络，连接服务器在TCP功能类的连接服务器的函数中，创建一个新的线程，用来接收数据并处理

循环的接收数据，防止粘包就先接收包大小，再接收包数据
接收到一个完整的数据包，就把数据发送给中介者类，中介者线程发送信号给核心功能类，通过核心功能类的槽函数dealdata参数去处理，在这个处理函数中，先取出这个数据的头四个字节，就是这个数据的协议编号，通过协议编号，在kernel类的map中，找到对应的协议处理函数，由这个函数去处理这个数据。【业务处理】

#### TCP版本

服务器记录每个上线客户端的socket

#### UDP版本

服务器记录每个上线客户端的IP和端口号即socket_addr
